# 第五章  子图的绘制及坐标轴共享

## 1.绘制固定区域的子图

​	matplotlib可以将整个画布规划成等分布局的m*n（行*列）的矩阵区域，并按照先行后列的方式对每个区域进行编号（编号从1开始），之后在选中的某个或某些区域中绘制单个或多个子图。

<img src="https://gitee.com/zou_tangrui/note-pic/raw/master/img/202310201039636.png" alt="image-20231020103944496" style="zoom:50%;" />

### 1.1.绘制单子图

​	使用pyplot模块的`subplot()`函数可以在规划好的某个区域中绘制单个子图。其语法结构为：

```python
subplot(nrows, ncols, index, projection, polar, sharex, sharey, 
label, **kwargs)
```

- `nrows`：表示规划区域的行数。
- `ncols`：表示规划区域的列数。
- `index`：表示选择区域的索引，默认从1开始编号。
- `projection`：表示子图的投影类型。
- `polar`：表示是否使用极坐标，默认值为False。若参数polar设为True，则作用等同于projection='polar'。



​	参数`nrows`、`ncols`、`index`既支持单独传参，也支持以一个3位整数（每位整数必须小于10）的形式传参。
`subplot()`函数会返回一个` Axes`类的子类`SubplotBase`的对象。 
​	Figure类对象可以使用`add_subplot()`方法绘制单子图，此方式与`subplot()`函数的作用是等价的。 

```python
import matplotlib.pyplot as plt

# 画布被规划为3x2的矩阵区域，之后在索引为6的区域中绘制子图
ax_one = plt.subplot(326)
ax_one.plot([1, 2, 3, 4, 5])
# 画布被绘画为3x1的矩阵区域，之后在索引为2的区域中绘制子图
ax_two = plt.subplot(312)
ax_two.plot([1, 2, 3, 4, 5])
plt.show()
```

运行结果：

<img src="https://gitee.com/zou_tangrui/note-pic/raw/master/img/202310201051620.png" alt="image-20231020105139549" style="zoom:50%;" />

### 1.2.实例：某工厂产品A与产品B去年的销售额分析

​	本实例要求根据下表的数据，先将画布规划成<font color='red'>`2*1`的矩阵区域</font>，并<font color='red'>在索引为1的区域中</font>绘制反映产品A和产品B销售额趋势的<font color='red'>折线图</font>；再将画布规划成<font color='red'>`2*2`的矩阵区域</font>，并<font color='red'>在索引为3的区域中</font>绘制反映产品A销售额占比的<font color='red'>饼图</font>；最后将画布规划成<font color='red'>`2*2`的矩阵区域</font>，并<font color='red'>在索引为4的区域中</font>绘制反映产品B销售额占比的<font color='red'>饼图</font>。

<img src="https://gitee.com/zou_tangrui/note-pic/raw/master/img/202310201055058.png" alt="image-20231020105520992" style="zoom:50%;" />

<img src="https://gitee.com/zou_tangrui/note-pic/raw/master/img/202310201055747.png" alt="image-20231020105529682" style="zoom:50%;" />

<img src="https://gitee.com/zou_tangrui/note-pic/raw/master/img/202310201055063.png" alt="image-20231020105543996" style="zoom:50%;" />

```python
import numpy as np
import matplotlib.pyplot as plt

plt.rcParams['font.sans-serif'] = ['SimHei']
plt.rcParams['axes.unicode_minus'] = False

x = [x for x in range(1, 13)]
y1 = [20, 28, 23, 16, 29, 36, 39, 33, 31, 19, 21, 25]
y2 = [17, 22, 39, 26, 35, 23, 25, 27, 29, 38, 28, 20]
labels = ['1月', '2月', '3月', '4月', '5月', '6月', '7月',
          '8月', '9月', '10月', '11月', '12月']

# 将画布规划成等分布局的2x1的矩阵区域，之后在索引为1的区域中绘制子图
ax1 = plt.subplot(211)
ax1.plot(x, y1, 'm--o', lw=2, ms=5, label='产品A')
ax1.plot(x, y2, 'g--o', lw=2, ms=5, label='产品B')
ax1.set_title('产品A与产品B的销售额趋势', fontsize=11)
ax1.set_ylim(10, 45)  # y轴区间
ax1.set_ylabel('销售额（亿元）')
ax1.set_xlabel('月份')
for xy1 in zip(x, y1):
    ax1.annotate("%s" % xy1[1], xy=xy1, xytext=(-5, 5), textcoords='offset points')
for xy2 in zip(x, y2):
    ax1.annotate("%s" % xy2[1], xy=xy2, xytext=(-5, 5), textcoords='offset points')
ax1.legend()
# 将画布规划成等分布局的2x2的矩阵区域，之后在索引为3的区域中绘制子图
ax2 = plt.subplot(223)
ax2.pie(y1, radius=1, wedgeprops={'width': 0.5}, labels=labels,
        autopct='%3.1f%%', pctdistance=0.75)
ax2.set_title('产品A的销售额')
# 将画布规划成等分布局的2x2的矩阵区域，之后在索引为4的区域中绘制子图
ax3 = plt.subplot(224)
ax3.pie(y2, radius=1, wedgeprops={'width': 0.5}, labels=labels,
        autopct='%3.1f%%', pctdistance=0.75)
ax3.set_title('产品B的销售额')
# 调整子图之间的距离
plt.tight_layout()
plt.show()
```

<img src="https://gitee.com/zou_tangrui/note-pic/raw/master/img/202310201120131.png" alt="image-20231020112043034" style="zoom:50%;" />

### 1.3.绘制多子图

​	使用pyplot模块的`subplots()`函数可以在规划好的所有区域中一次绘制多个子图。

```python
subplots（nrows=1，ncols=1，sharex=False，sharey=False，squeeze=True，subplot_kw=None，gridspec_kw=None，**fig_kw）
```

- `nrows`：表示规划区域的行数，默认为1。
- `ncols`：表示规划区域的列数，默认为1。
- `sharex, sharey`：表示是否共享子图的x轴或y轴。



​	`subplots()`函数会返回包含两个元素的元组，其中该元组的第一个元素为`Figure`对象，第二个元素为`Axes`对象或`Axes`对象数组。

```python
import matplotlib.pyplot as plt

# 将画布划分为2x2的等分区域
fig, ax_arr = plt.subplots(2, 2)
# 获取sx_arr数组第1行第0列的元素，也就是第3个区域
ax_thr = ax_arr[1, 0]
ax_thr.plot([1, 2, 3, 4, 5])
plt.show()
```

<img src="https://gitee.com/zou_tangrui/note-pic/raw/master/img/202310201133488.png" alt="image-20231020113321404" style="zoom:50%;" />

